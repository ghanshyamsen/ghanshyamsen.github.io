<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Implementing OAuth 2.0 in Laravel: Google & GitHub Login | Ghanshyam Sen</title>
  <meta name="description" content="Step-by-step guide to implementing social authentication with OAuth 2.0, handling tokens securely, and managing user sessions." />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" />
  <link href="../style.css" rel="stylesheet" />
  <script defer src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script defer src="../scripts/layout.js"></script>
</head>
<body class="page" data-page="blog">
  <div id="header"></div>
  <main style="padding-top: 100px;">
    <section class="py-5">
      <div class="container">
        <div class="blog-header">
          <div class="blog-header-meta">
            <span class="blog-card-category">Security</span>
            <span><i class="bi bi-calendar3"></i> December 27, 2025</span>
            <span><i class="bi bi-clock"></i> 9 min read</span>
          </div>
          <h1 class="blog-title">Implementing OAuth 2.0 in Laravel: Google & GitHub Login</h1>
          <p class="section-subtitle">Step-by-step guide to implementing social authentication with OAuth 2.0, handling tokens securely, and managing user sessions.</p>
        </div>
        <img src="../images/blog-auth.png" alt="OAuth 2.0 Laravel Implementation" class="blog-featured-image" />
        <article class="blog-content">
          <p>Social authentication improves user experience by eliminating password fatigue and speeding up registration. In this guide, I'll show you how to implement OAuth 2.0 with Google and GitHub in Laravel using Laravel Socialite.</p>

          <h2>1. Install Laravel Socialite</h2>
          <p>Laravel Socialite provides an expressive, fluent interface to OAuth authentication:</p>
          
          <pre><code>composer require laravel/socialite

# Add to config/app.php providers array
Laravel\Socialite\SocialiteServiceProvider::class,

# Add to aliases
'Socialite' => Laravel\Socialite\Facades\Socialite::class,</code></pre>

          <h2>2. Configure OAuth Providers</h2>
          <p>Add your OAuth credentials to config/services.php:</p>
          
          <pre><code>// config/services.php
return [
    'google' => [
        'client_id' => env('GOOGLE_CLIENT_ID'),
        'client_secret' => env('GOOGLE_CLIENT_SECRET'),
        'redirect' => env('GOOGLE_REDIRECT_URI'),
    ],
    
    'github' => [
        'client_id' => env('GITHUB_CLIENT_ID'),
        'client_secret' => env('GITHUB_CLIENT_SECRET'),
        'redirect' => env('GITHUB_REDIRECT_URI'),
    ],
];</code></pre>

          <h2>3. Create OAuth Controller</h2>
          <p>Handle the OAuth flow with a dedicated controller:</p>
          
          <pre><code>// app/Http/Controllers/Auth/SocialAuthController.php
namespace App\Http\Controllers\Auth;

use App\Http\Controllers\Controller;
use App\Models\User;
use Illuminate\Support\Facades\Auth;
use Laravel\Socialite\Facades\Socialite;

class SocialAuthController extends Controller
{
    public function redirectToProvider($provider)
    {
        return Socialite::driver($provider)->redirect();
    }
    
    public function handleProviderCallback($provider)
    {
        try {
            $socialUser = Socialite::driver($provider)->user();
            
            $user = User::updateOrCreate(
                ['email' => $socialUser->getEmail()],
                [
                    'name' => $socialUser->getName(),
                    'avatar' => $socialUser->getAvatar(),
                    'provider' => $provider,
                    'provider_id' => $socialUser->getId(),
                    'provider_token' => $socialUser->token,
                ]
            );
            
            Auth::login($user, true);
            
            return redirect()->intended('/dashboard');
            
        } catch (\Exception $e) {
            return redirect('/login')->with('error', 'Authentication failed');
        }
    }
}</code></pre>

          <h2>4. Update User Migration</h2>
          <p>Add OAuth fields to your users table:</p>
          
          <pre><code>// database/migrations/xxxx_add_oauth_fields_to_users_table.php
Schema::table('users', function (Blueprint $table) {
    $table->string('provider')->nullable();
    $table->string('provider_id')->nullable();
    $table->text('provider_token')->nullable();
    $table->string('avatar')->nullable();
    $table->string('password')->nullable()->change();
});</code></pre>

          <h2>5. Define Routes</h2>
          <p>Add routes for OAuth flow:</p>
          
          <pre><code>// routes/web.php
use App\Http\Controllers\Auth\SocialAuthController;

Route::get('auth/{provider}', [SocialAuthController::class, 'redirectToProvider'])
    ->name('social.redirect');
    
Route::get('auth/{provider}/callback', [SocialAuthController::class, 'handleProviderCallback'])
    ->name('social.callback');</code></pre>

          <h2>6. Add Login Buttons</h2>
          <p>Create social login buttons in your login view:</p>
          
          <pre><code><!-- resources/views/auth/login.blade.php -->
<div class="social-login">
    <a href="{{ route('social.redirect', 'google') }}" 
       class="btn btn-outline-dark">
        <i class="bi bi-google"></i> Continue with Google
    </a>
    
    <a href="{{ route('social.redirect', 'github') }}" 
       class="btn btn-outline-dark">
        <i class="bi bi-github"></i> Continue with GitHub
    </a>
</div></code></pre>

          <h2>7. Security Best Practices</h2>
          <div class="card-dark" style="padding: 1.5rem; margin: 2rem 0;">
            <ul style="margin: 0; color: var(--text-muted);">
              <li><strong style="color: var(--text);">State parameter</strong> - Socialite handles CSRF protection automatically</li>
              <li><strong style="color: var(--text);">Token storage</strong> - Encrypt provider tokens in database</li>
              <li><strong style="color: var(--text);">Email verification</strong> - Trust provider's email verification</li>
              <li><strong style="color: var(--text);">Error handling</strong> - Always catch OAuth exceptions</li>
              <li><strong style="color: var(--text);">Scope management</strong> - Request only necessary permissions</li>
            </ul>
          </div>

          <h2>8. Advanced: Linking Accounts</h2>
          <p>Allow users to link multiple OAuth providers:</p>
          
          <pre><code>// app/Models/User.php
public function socialAccounts()
{
    return $this->hasMany(SocialAccount::class);
}

// app/Models/SocialAccount.php
class SocialAccount extends Model
{
    protected $fillable = [
        'user_id', 'provider', 'provider_id', 'provider_token'
    ];
    
    public function user()
    {
        return $this->belongsTo(User::class);
    }
}</code></pre>

          <h2>Key Takeaways</h2>
          <div class="card-dark" style="padding: 1.5rem; margin: 2rem 0;">
            <ul style="margin: 0; color: var(--text-muted);">
              <li><strong style="color: var(--text);">Laravel Socialite</strong> - Simplifies OAuth implementation</li>
              <li><strong style="color: var(--text);">Multiple providers</strong> - Easy to add Google, GitHub, Facebook, etc.</li>
              <li><strong style="color: var(--text);">Security first</strong> - Handle tokens securely and validate responses</li>
              <li><strong style="color: var(--text);">User experience</strong> - Faster registration, no password management</li>
              <li><strong style="color: var(--text);">Account linking</strong> - Allow users to connect multiple providers</li>
            </ul>
          </div>

          <h2>Conclusion</h2>
          <p>OAuth 2.0 authentication with Laravel Socialite is straightforward to implement and significantly improves user experience. Start with one or two providers, then expand based on your user base preferences.</p>

          <div class="blog-tags">
            <span class="blog-tag">Laravel</span>
            <span class="blog-tag">OAuth</span>
            <span class="blog-tag">Security</span>
            <span class="blog-tag">Authentication</span>
          </div>

          <div class="card-dark" style="display: flex; gap: 1.5rem; align-items: center; padding: 1.5rem; margin: 2rem 0;">
            <img src="../assest/Profile.png" alt="Ghanshyam Sen" style="width: 80px; height: 80px; border-radius: 50%; object-fit: cover;" />
            <div>
              <h5 style="margin: 0 0 0.5rem; color: var(--text);">Written by Ghanshyam Sen</h5>
              <p style="margin: 0; color: var(--text-muted); font-size: 0.9rem;">Senior Full-Stack Engineer with 6+ years of experience building scalable web applications.</p>
            </div>
          </div>

                    <div class="blog-nav">
            <a href="postgresql-vs-mysql-2026.html" class="blog-nav-item prev">
              <div class="blog-nav-label"><i class="bi bi-arrow-left"></i> Previous</div>
              <div class="blog-nav-title">PostgreSQL vs MySQL</div>
            </a>
            <a href="aws-s3-presigned-urls.html" class="blog-nav-item next">
              <div class="blog-nav-label">Next <i class="bi bi-arrow-right"></i></div>
              <div class="blog-nav-title">AWS S3 Pre-signed URLs</div>
            </a>
          </div>
        </article>
      </div>
    </section>
  </main>
  <div id="footer"></div>
</body>
</html>

